#### Задача 1
*Есть регистр Продажи. Измерение - Клиент, Товар. Ресурсы - Количество
Запросом получить всех клиентов, кто купил товар А, но не купил товар B*

*fix:  Используйте РН обороты а не РС*

```SQL
ВЫБРАТЬ
	Продажи.Клиент.Ссылка КАК Клиент
ИЗ
	РегистрНакопления.Продажи КАК Продажи
ГДЕ 
	Продажи.Товар = &КуплТовар
И
	Продажи.Клиент 
	НЕ В (ВЫБРАТЬ
			Продажи.Клиент
		ИЗ
			РегистрНакопления.Продажи КАК Продажи
		ГДЕ
			Продажи.Товар = &ИсклТовар)
```

Результат:

![1res](https://user-images.githubusercontent.com/36735568/191975730-1897d9c4-c377-4883-aafc-f66ec197ea1c.png)


Список продаж:


![1sel](https://user-images.githubusercontent.com/36735568/191975776-b1a16662-600e-42fc-8dca-67b11de58e53.png)





#### Задача 2
*Есть таблица значений с полями Контрагент и Сумма. Напишите процедуру, которая удалит из таблицы все строки, с суммой меньше 100 рублей*

*fix: Просьба решить без построителя запроса*

```SQL
&НаСервере
Процедура ПолучитьНаСервере()   
	
	Таблица = СоздатьТаблицу();   
	
	ЗапросДанных = Новый Запрос;
	ЗапросДанных.Текст = "
				| ВЫБРАТЬ *
				| ПОМЕСТИТЬ Таблица 
				| ИЗ &ТаблицаЗначений КАК Таблица; 
				|
				| ВЫБРАТЬ 
				|	Таблица.Контрагент КАК Контрагент,
				|	Таблица.Сумма КАК Сумма
				| ИЗ Таблица КАК Таблица
				| ГДЕ
				|	Таблица.Сумма > 100";
	
	ЗапросДанных.УстановитьПараметр("ТаблицаЗначений", Таблица);
	Результат = ЗапросДанных.Выполнить().Выгрузить();
	Отчет.ТабличнаяЧасть.Загрузить(Результат);
	Отчет.ТабличнаяЧасть.Сортировать("Сумма");
	
КонецПроцедуры


```
Результат:



![2](https://user-images.githubusercontent.com/36735568/191988639-b7b84d62-955f-4789-8041-09618319b041.png)



#### Задача 3
*В конфигурации есть регистр сведений Производственный календарь. Измерение - Дата, ресурс - Рабочий день(булево), Истина - если день рабочий, иначе  - Ложь
Реализовать функцию, которая прибавляет X рабочих Дней к исходной дате.*

*fix:  Тоже решите плз через запрос*

```js

&НаСервере
Функция ДобавитьДнейНаСервере()
	ИсхДата = КонецДня(Отчет.ИсходнаяДата); 
	РабочихДней = Отчет.КоличествоДней;
	
	ЗапросДанных = Новый Запрос;
	ЗапросДанных.Текст = "
			| ВЫБРАТЬ ПЕРВЫЕ "+РабочихДней+"
			|   Календарь.Дата КАК Дата
			| ПОМЕСТИТЬ СписокДат
			| ИЗ
			|   РегистрСведений.ПроизводственныйКалендарь КАК Календарь 
			| Где 
			|   Календарь.РабочийДень = ИСТИНА
			| И 
			|   Календарь.Дата > &ИсхДата;
			|
			| ВЫБРАТЬ МАКСИМУМ(СписокДат.Дата) КАК Дата
			| ИЗ СписокДат КАК СписокДат";  
	
	ЗапросДанных.УстановитьПараметр("ИсхДата", ИсхДата);
	ПолученныеДанные = ЗапросДанных.Выполнить().Выгрузить(); 
	Возврат ПолученныеДанные[0].Дата;
		
КонецФункции


```
Результат:

![3](https://user-images.githubusercontent.com/36735568/192012224-4849aa0d-6ad4-49b0-9d1b-0030554dcab4.png)

Календарь:

![3calend](https://user-images.githubusercontent.com/36735568/190375591-df3fc9d9-ed13-4851-a24d-7858b44d272b.png)





#### Задача 4.
*Напишете текст запроса (одним запросом) для получения курса валюты из периодического (периодичность день) регистра сведений «Курсы валют» для документов «Поступление» на дату каждого документа.
Регистр сведений «Курсы валют»:*

```SQL
&НаСервере
Процедура ЗапросНаСервере()
	ЗапросДанных = Новый Запрос;
	ТекстЗапроса = "ВЫБРАТЬ
				| Поступление.Номер КАК ДокументПоступления,
				| Поступление.Валюта КАК Валюта,
				| Поступление.Дата КАК ДатаДокумента,
				| КурсыВалют.Курс КАК КурсВалютыНаДатуДокумента
				| ИЗ
				| Документ.Поступление КАК Поступление
				| ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют КАК КурсыВалют 
				| ПО Поступление.Валюта = КурсыВалют.Валюта
				| И НАЧАЛОПЕРИОДА(Поступление.Дата, ДЕНЬ) = КурсыВалют.Период ";
				
	ЗапросДанных.Текст = ТекстЗапроса;
	ПолученныеДанные = ЗапросДанных.Выполнить().Выгрузить();
	
	Отчет.ТабличнаяЧасть1.Загрузить(ПолученныеДанные);	
	
КонецПроцедуры

```
Результат:

![4res](https://user-images.githubusercontent.com/36735568/190412223-298b513a-a7d9-44ae-ba98-7c713c6ab967.png)

Курс:

![4course](https://user-images.githubusercontent.com/36735568/190412291-d742ca0e-d28c-4bd7-8621-540dd9baa78c.png)

Поступления:

![4pos](https://user-images.githubusercontent.com/36735568/190412352-f37dd93d-f43f-4bee-90f7-3bf56745f356.png)



#### Задача 5
*Получить продажи помесячно нарастающим итогом.
Например. Контрагент “Рога и копыта” купил в январе на 100 рублей, в феврале на 50 рублей, в марте ничего не купил , в апреле на  100  рублей*

*fix: Продажи должны быть оборотными. РН*
```SQL
ВЫБРАТЬ       
	Продажа.Контрагент КАК Контрагент,
	НАЧАЛОПЕРИОДА(Продажа.Период, МЕСЯЦ) КАК Период,
	СУММА(Продажа.Сумма) КАК Сумма
ПОМЕСТИТЬ ТаблицаПродаж	
ИЗ
	РегистрНакопления.Продажа КАК Продажа
ГДЕ 
	НАЧАЛОПЕРИОДА(Продажа.Период, ГОД) = НАЧАЛОПЕРИОДА(&ДатаГод, ГОД) 
И
	Продажа.Контрагент = &Контрагент
СГРУППИРОВАТЬ ПО
	Продажа.Контрагент,
	НАЧАЛОПЕРИОДА(Продажа.Период, МЕСЯЦ);

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(Календарь.Дата, МЕСЯЦ) КАК Период
ПОМЕСТИТЬ Календарь
ИЗ
	РегистрСведений.ПроизводственныйКалендарь КАК Календарь
ГДЕ
	НАЧАЛОПЕРИОДА(Календарь.Дата, ГОД) = НАЧАЛОПЕРИОДА(&ДатаГод, ГОД)
СГРУППИРОВАТЬ ПО
	НАЧАЛОПЕРИОДА(Календарь.Дата, МЕСЯЦ);
	
ВЫБРАТЬ
	Календарь.Период КАК Период,
	ТаблицаПродаж.Контрагент КАК Контрагент,
	ТаблицаПродаж.Сумма КАК Сумма,
	СУММА(Накопитель.Сумма) КАК СуммаНарастающимИтогомСНачалаГода
ИЗ
	Календарь КАК Календарь
ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаПродаж КАК ТаблицаПродаж
	ПО Календарь.Период = ТаблицаПродаж.Период
ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаПродаж КАК Накопитель
	ПО Календарь.Период >= Накопитель.Период
СГРУППИРОВАТЬ ПО
	Календарь.Период,
	ТаблицаПродаж.Контрагент,
	ТаблицаПродаж.Сумма
УПОРЯДОЧИТЬ ПО
	Календарь.Период;	
	


```

Результат:

![5_s](https://user-images.githubusercontent.com/36735568/192027422-98b0b129-8ec3-45ee-a6ca-933d2c9f2698.png)

С суммой продаж

![5](https://user-images.githubusercontent.com/36735568/192027452-ea5c1d2e-60c5-4bb0-a943-8b93f06ee7c8.png)

Таблица продаж

![5a](https://user-images.githubusercontent.com/36735568/192027997-4a67d0cb-1e8a-4671-9ab0-519c996572b1.png)

#### Задача 6
*В конфигурации, которую вы создаете с нуля, необходимо иметь возможность учитывать дебиторскую задолженность по срокам долга.
Документы, которые уже есть в конфигурации:
Реализация  - регистрирует продажу
Приходный кассовый ордер - регистрирует оплату от клиента
Нужно получать отчет в виде:
Документ Реализации / Сумма / Сумма оплачено / Сумма просроченная/ Срок просрочки в днях.*

Сначала я создам справочники "Контрагенты" и "Номенклатура".

Документ "Реализация" будет иметь Реквизиты:
* Контрагент
* Сумма
* Оплачен - булево
* СуммаПоступлений - здесь будет храниться сумма поступивших оплат, так как оплаты могут приходить частями.

В табличной части будет две таблицы, в первую будут добавляться товары, во вторую документы оплаты программно.


![6sel_sel](https://user-images.githubusercontent.com/36735568/190869537-afb0b113-6f8c-4a20-8f95-ca71b2de093f.png) 
![6sel_pos](https://user-images.githubusercontent.com/36735568/190869546-fdd06d1d-e5a9-4979-bbd8-9d8e75e1f3a0.png)


Предполагается, что для приходного кассового ордера должен быть документ основание. Соответсвенно, я добавил реализацию в реквизит.

В модуль объекта ПриходныйКассовыйМодуль добавил следующий код:
```js
&НаСервере
Процедура ПриЗаписи(Отказ) 

	Реализация = ДокументОснование.ПолучитьОбъект();
	РеализацияПоступление = Реализация.Поступления.Добавить(); // Добавляем в табличную часть документа реализации этот ПКО
	РеализацияПоступление.ДокументОплаты = ЭтотОбъект.Ссылка; 
	
	Сумма = 0;						
	Для Каждого ПКО ИЗ Реализация.Поступления Цикл		  // Получаем сумму из всех ПКО по этой реализации
		Сумма = Сумма + ПКО.ДокументОплаты.Сумма;
	КонецЦикла; 
	
	Если Реализация.Сумма = Сумма Тогда
		Реализация.Оплачен = Истина;			  // Если сумма всех ПКО равна сумме документа, документ помечается оплаченным. 
	КонецЕсли;    
	
	Если Сумма > Реализация.Сумма Тогда			  // Отказ, если сумма всех ПКО, включая текущий выше суммы Реализации 
		Отказ = Истина;
	КонецЕсли;
	
	Реализация.СуммаПоступлений = Сумма;
	
	Реализация.Записать(); 
		
КонецПроцедуры

```

Теперь требуемый отчёт с дебиторской задолженностью будет иметь следующий код:

```js
&НаСервере
Процедура СформироватьОтчёт()
	ЗапросДанных = Новый Запрос;
	ТекстЗапроса = "ВЫБРАТЬ
			|  Реализации.Ссылка КАК ДокументРеализации,
			|  ЕСТЬNULL(Реализации.Сумма, 0) -
			|	ЕСТЬNULL(Реализации.СуммаПоступлений, 0) КАК СуммаПросроченная,
			|  ВЫБОР  
			|     КОГДА НЕ Реализации.Оплачен
			|       ТОГДА 
			|         ВЫРАЗИТЬ(ДЕНЬ(&Дата) КАК Число(10,0)) - ВЫРАЗИТЬ(ДЕНЬ(Реализации.Дата) КАК Число(10,0)) 
			|     КОНЕЦ КАК СрокПросрочкиВДнях	
			|  ИЗ
			|   Документ.Реализация КАК Реализации"; 
			
	ЗапросДанных.УстановитьПараметр("Дата", ТекущаяДата());
	ЗапросДанных.Текст = ТекстЗапроса;
	ПолученныеДанные = ЗапросДанных.Выполнить().Выгрузить();
	Отчет.Таблица.Загрузить(ПолученныеДанные);
КонецПроцедуры

```

Результат:

![5](https://user-images.githubusercontent.com/36735568/190870968-e895ee4a-e84f-4b74-b173-c0f01c00d3a2.png)

Список продаж:

![5_sell](https://user-images.githubusercontent.com/36735568/190871003-4218aea4-cf32-4bfa-85c0-f7127fd46bc9.png)


Спасибо!
